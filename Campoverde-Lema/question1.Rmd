Question one, does hospital impact the mortality rate? 

```{r}

library(tidyverse)
hospitals <- read_csv("https://raw.githubusercontent.com/36-SURE/36-SURE.github.io/main/data/hospitals.csv")

View(hospitals)
str(hospitals)

```

#this filters out unknown and none in our data
#if you want to change the orders on the graph thant change line 18 
```{r}
hospitals_type <- hospitals |> 
  filter(Rating.Mortality != "None", Facility.Type != "Unknown") |> 
  mutate(Rating.Mortality = factor(Rating.Mortality, levels = c("Below", "Same", "Above")),
         Facility.Type = factor(Facility.Type))
         
```



```{r}
# Calculate proportions
mortality_proportion <- hospitals_type |> 
  group_by(Facility.Type, Rating.Mortality) |> 
  summarize(count = n(), .groups = 'drop') |> 
  group_by(Facility.Type) |> 
  mutate(proportion = count / sum(count))

#Stacked bar graph
mortality_proportion |> 
  ggplot(aes(x = Facility.Type, y = proportion, fill = Rating.Mortality)) +
  geom_bar(stat = "identity") +
  scale_y_continuous(labels = scales::percent) +
  labs(title = "Proportion of Mortality Ratings by Hospital Type", 
       x = "Hospital Type", 
       y = "Proportion", 
       fill = "Mortality Rating") +
  theme_minimal()
```


```{r}
mortality_summary <- hospitals_type |> 
  group_by(Facility.Type, Rating.Mortality) |> 
  summarize(count = n(), 
            .groups = 'drop')

mortality_summary |> 
  ggplot(aes(x = Facility.Type, y = count, fill = Rating.Mortality)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(
    title = "Hospital Type vs Mortality Rate", 
    x = "Hospital Type", 
    y = "Count", 
    fill = "Mortality Rating")

```




