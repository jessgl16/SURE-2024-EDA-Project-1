# Question 2: 

Question: How many hospitals are located in each state?
#MAKE A CHOROPLETH MAP !!
- get the packages
- create a state name look up table (a tibble??????????)
- agg hospitals by states
- mutate with facility state
- count and left join
- get the map data (states <- map_data("states"))
- merge another left join with region and state name
- merge hospital counts, and plot
plot: x = long, y = lat, group = group, fill = n

Load data and libraries to use and preprocessing

```{r}

library(viridis)
library(statebins)
library(datasets)
library(ggplot2)
library(tidyverse)
library(dplyr)
library(maps)

hospitals <- read_csv("https://raw.githubusercontent.com/36-SURE/36-SURE.github.io/main/data/hospitals.csv")
us_states <- map_data("state")

groupedStates <- hospitals |>
  group_by(Facility.State) |>
  summarise(count = n())

groupedStates$region <- tolower(state.name[match(groupedStates$Facility.State, state.abb)])

# View(groupedStates)
mergedData <- left_join(groupedStates, us_states, by = c("region"))
# View(mergedData)

```

create choropleth map

```{r}
mergedData |>
  ggplot(aes(x = long, y = lat, group = group, fill = count)) +
  geom_polygon(color = "black") +
  coord_map("polyconic") +
  # scale_fill_gradient(low = "midnightblue", high = "lightpink")
  scale_fill_viridis_c() +
  labs(
    x = "",
    y = "",
    title = "Hospital Counts by State",
    subtitle = "Data from CORGIS Dataset Project"
  ) +
  scale_y_continuous(labels = NULL) +
  scale_x_continuous(labels = NULL) +
  theme_light() +
  theme(
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    strip.background = element_blank(),
    plot.title = element_text(hjust = 0.5, face = "bold", size = 14),
    plot.subtitle = element_text(hjust = 0.5, size = 10),
    axis.text = element_text(size = 12),
  )

```

